
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd>

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-CN" lang="zh-CN">
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <meta name="author" content="Cubernet" />
    <title>Cubernet'Blog - 趣图</title>
    <meta name="name" content="Cubernet'Blog" />
    <meta name="description" content="刘小垒的博客" />
    <meta name="keywords" content= "" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link href="/feed/" rel="alternate" title="Cubernet" type="application/atom+xml" />
    <link rel="stylesheet" href="/media/css/style.css" />
    <link rel="stylesheet" href="/media/css/highlight.css" />
    <script type="text/javascript" src="/media/js/jquery-1.7.1.min.js"></script>
    
    
    <script type="text/javascript" src="/media/js/outliner.js"></script>
    
    <style>
        body,ul,p,h2,h3{margin:0;padding:0;}
        li{list-style:none};
        a {text-decoration:none;}
        h3 {font:14px "微软雅黑";}
        strong { font-weight:normal; font-size:12px; color:#808080;height:24px; line-height:24px; float:left; padding:0 7px; cursor:pointer;}
        .clear{zoom:1}
        .clear:after{content:"";display:block;clear:both;}
        .parent{width:1000px; overflow:hidden; margin:15px auto 0;}        
        .parent li { width:240px; float:left;margin-right:10px;overflow:hidden;}
        .parent li div[class='tag']{width:229px;border:1px solid #b6b6b6; margin-bottom:10px; border-top:4px solid #6f6f6f; padding:12px 0 0 9px;}
        .parent li:first-child a{ background:#f0f0f0; text-decoration:none; margin:4px 5px 5px 0;display:inline-block; height:22px; line-height:22px; font-size:12px; color:#a0a0a0; padding:0 10px; border:1px solid #e2e2e2; border-radius:20px;}
        .parent li:first-child a:nth-of-type(1) { background:#ff9231; color:#fff;}
        .parent li:last-child{margin-right:0;}
        .parent li div[class='boBtn'] { width:221px; margin:10px 0 0 -10px; padding-top:17px;}
        .parent li div[class='boBtn'] div {margin-bottom:10px;}
        .parent li div[class='boBtn'] p{ float:left; height:24px; line-height:24px; background:#fefefe;margin-bottom:6px; border-radius:15px;-webkit-border-radius:15px;-moz-border-radius:15px; border:1px solid #ddd; overflow:hidden;} 
        .parent li div[class='boBtn'] span { float:left; padding:0 10px; font-size:12px; height:24px; line-height:24px;}
        .active  { background:#ff9231; color:#fff;}
        .parent .pic {margin-bottom:10px; border:1px solid #dadada; overflow:hidden; }
        .parent .pic h3 { padding-top:5px;height:20px; line-height:20px; text-align:center; color:#00c0ff; text-shadow:1px 1px 3px rgba(255,255,255,.5)}
        .parent .pic p {  font-size:12px; color:#aaa;padding:5px 10px; text-indent:2em; line-height:20px; background:#fbfbfb;color:#aaa;}
        li div img { width:240px; border:none; vertical-align:top; }
    </style>
    

  </head>
  <body>
    <div id="container">
      <div id="main" role="main">
        <nav id="real_nav">
        <span><a title="网站首页" class="" href="/">首页</a></span>
        <span><a title="文章分类" class="" href="/categories/">分类</a></span>
        <span><a title="标签索引" class="" href="/tags/">标签</a></span>
        <span><a title="趣图分享" class="" href="/funny/">趣图</a></span>
        <!--<span><a title="友情链接" class="" href="/links/">链接</a></span>-->
        <span><a title="留言交流" class="" href="/guestbook/">留言</a></span>
        <span><a title="关于站长" class="" href="/about/">关于</a></span>
        <span><a title="站内搜索" class="" href="/search/">搜索</a></span>
        <!--<span><a title="种子订阅" class="" href="/feed/" target="_blank">订阅</a></span>-->
        </nav>

        <div class="maincontent">
            <header>
            <span class="header-span"><h1>趣图</h1></span>         
            <div class="header-div">
                <span><a title="网站首页" class="" href="/">首页</a></span>
                <span class="line-span">|</span>
                <span><a title="文章分类" class="" href="/categories/">分类</a></span>
                <span class="line-span">|</span>
                <span><a title="留言交流" class="" href="/guestbook/">留言</a></span>
                <span class="line-span">|</span>
                <span><a title="关于站长" class="" href="/about/">关于</a></span>
                <span class="line-span">|</span>
                <span><a title="站内搜索" class="" href="/search/">搜索</a></span>
            </div>
            </header>
            
            <div class="div-art">
                <article class="content">
                <section class="post">
<script src="/media/js/move.js" type="text/javascript"></script>




<p>如果涉及到版权问题，请及时联系我。</p>




<ul class="parent clear" id="picsul">
    <li></li>
    <li></li>
    <li></li>
</ul>




<script>

        
        var oParent=getByClass('parent')[0];
        
        var aLi=oParent.getElementsByTagName('li');
        var iPage=1;
        var iOpen=true;
        var jsonData = null;

        window.onload = function(){
            var jsonFile = "/pic.json";
                var xhr = (window.XMLHttpRequest) ? new XMLHttpRequest() : new ActiveXObject("Microsoft.XMLHTTP");
                xhr.open("GET", jsonFile, true);
                xhr.onreadystatechange = function(){
                    if (xhr.status==200 && xhr.readyState==4){
                        try{
                            jsonData = JSON.parse( xhr.responseText );
                            console.log( "data loaded successfully" );
                            showList();        //初始化加载第一批图片
                            }catch(err){
                            console.log( err );
                            jsonData = null;
                        }
                    }
                }
                xhr.send(); 
        };


        function fnMove() {        //鼠标经过图片透明度变化
                var aDiv=getByClass('pic');
                for(var i=0;i<aDiv.length;i++) {
                var oImg=aDiv[i].getElementsByTagName('img')[0];
                var bDiv=document.createElement('div');
                var bImg=document.createElement('img');
                var btitle=document.createElement('div');
                        oImg.onmouseover=function() {
                                this.style.filter='alpha(opacity:60)';
                                this.style.opacity=0.6;                                      
                        }
                        oImg.onmouseout=function() {
                                this.style.filter='alpha(opacity:100)';
                                this.style.opacity=1;          
                        }
                        oImg.onclick=function(){
                            bDiv.appendChild(btitle);
                            bDiv.appendChild(bImg);
                                btitle.innerHTML="再次单击关闭大图";
                                bImg.src = this.src;
                                document.getElementById('picsul').appendChild(bDiv);
                                btitle.style.fontSize="12px";
                                btitle.style.color="#333333";
                                btitle.style.height="15px";
                                bDiv.style.backgroundColor="#DDDDDD";
                                bDiv.style.zIndex="2";
                                bDiv.style.position="absolute";
                                bDiv.style.left=document.body.offsetWidth/3;
                                bDiv.style.top=document.body.scrollTop+50;
                                bDiv.style.cssFloat="left"; 
                                bDiv.style.border="solid 1px";
                                bDiv.style.borderColor="#0099ff";
                                bDiv.style.borderRadius="6px";

                                bImg.onclick=function(){
                                  document.getElementById('picsul').removeChild(bDiv);
                                }
                        }
                }
        }
        
        

        window.onscroll=function() {
                
                var _index=        iMin();        //最小高度li的下标
                var oLi=aLi[_index];        //最小高度的li
                var ih=pos(oLi)+oLi.offsetHeight;
                if(ih<(viewH()+scrollY())) {
                        showList();
                }
        };

        function showList() {
                if(!iOpen) return;
                iOpen=false;
                if(!jsonData) return;
                iPage++;

                var i=0;

                function show1() {
                    var oDiv=document.createElement('div');
                    var oImg=document.createElement('img');
                    var oP=document.createElement('p');
                    oDiv.className='pic'; 
                    var j = jsonData.length/2;
                    oP.innerHTML=jsonData[i+j].title || '暂无介绍';                  
                    oDiv.appendChild(oImg);
                    oDiv.appendChild(oP);
                    oImg.src="";
                    aLi[iMin()].appendChild(oDiv);
                    fnMove();//调用经过事件
                    if(jsonData[i].url) {
                        oImages=new Image();
                        oImages.onload=function() {
                        oImg.src=this.src;
                        oImg.style.filter='alpha(opacity:0)';        //图片加载完成时，进行透明度变化
                        oImg.style.opacity=0;
                        startMove(oImg,{
                        opacity:100        
                        });        
                        if(i<jsonData.length/2-1) {
                            i++;
                            show1();        
                        }else {
                            iOpen=false;        
                        }
                      }
                        oImages.src=jsonData[i].url;                                               
                    }else {                                //当图片加载失败走这里
                        if(i<jsonData.length/2-1) {        
                            i++;
                            show1();        
                        }else {
                            iOpen=false;        
                        }
                    }        
                                                        
                }
            show1();
                                              
        }

        
        

        //函数封装
        function iMin() {
                var ih=aLi[0].offsetHeight;
                var _index=0;
                for(var i=1;i<aLi.length;i++) {
                        if(ih>aLi[i].offsetHeight) {
                                ih=aLi[i].offsetHeight;
                                _index=i;        
                        }
                }
                return _index;
        }

        function getByClass(sClass,parent) {
                var aEle=(parent || document).getElementsByTagName('*')
                var arr=[];
                var re=new RegExp('\\b' + sClass + '\\b');
                for(var i=0;i<aEle.length;i++) {
                        if(re.test(aEle[i].className)) {
                                arr.push(aEle[i]);        
                        }
                        
                }
                return arr;
        }
        
        function pos(obj) {
                var iTop=0;        
                while(obj) {
                        iTop +=obj.offsetTop;
                        obj=obj.offsetParent;
                }
                return iTop;
                
        }
        function viewH() {
                return document.documentElement.clientHeight;        
        }
        function scrollY() {
                return document.documentElement.scrollTop || document.body.scrollTop;        
        }

        
</script>


</section>



                </article>
            </div>
        </div>
      </div>

    <footer>
        <p><small>
            Powered by <a href="http://jekyllrb.com" target="_blank">Jekyll</a> @ <a href="http://github.com/cubernet" target="_blank" title="项目主页">GitHub</a>
             | <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/cn/" target="_blank" title="许可协议">©</a> 2013 - 2014 <a href="/about/">Cubernet</a>
             | <script type="text/javascript">var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fcbf651a0c9c199e73857441cc83b3884' type='text/javascript'%3E%3C/script%3E"));
             </script>

			<script>window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"2","bdMiniList":false,"bdPic":"","bdStyle":"0","bdSize":"16"},"slide":{"type":"slide","bdImg":"5","bdPos":"right","bdTop":"174"},"image":{"viewList":["qzone","tsina","tqq","renren","weixin"],"viewText":"分享到：","viewSize":"16"},"selectShare":{"bdContainerClass":null,"bdSelectMiniList":["qzone","tsina","tqq","renren","weixin"]}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];</script>
		</small></p>
    </footer>
    </div>
  </body>
</html>
